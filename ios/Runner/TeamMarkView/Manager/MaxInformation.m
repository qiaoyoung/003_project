
#import <Foundation/Foundation.h>
typedef struct {
    Byte fishingEconomist;
    Byte *refugeeConservation;
    unsigned int quitView;
    bool auraHare;
} TanData;

NSString *StringFromTanData(TanData *data);


//: zh_CN
TanData str_biologicTitle = (TanData){88, (Byte []){34, 48, 7, 27, 22, 110}, 5, false};


//: zh_strings
TanData str_byShowData = (TanData){239, (Byte []){149, 135, 176, 156, 155, 157, 134, 129, 136, 156, 80}, 10, false};


//: ko_strings
TanData str_edgeName = (TanData){228, (Byte []){143, 139, 187, 151, 144, 150, 141, 138, 131, 151, 38}, 10, false};


//: spa_strings
TanData str_vaccinePotValue = (TanData){58, (Byte []){73, 74, 91, 101, 73, 78, 72, 83, 84, 93, 73, 252}, 11, false};


//: resources
TanData str_rawWeaponTitle = (TanData){238, (Byte []){156, 139, 157, 129, 155, 156, 141, 139, 157, 251}, 9, false};


//: it_strings
TanData str_advanceSpeciallyData = (TanData){167, (Byte []){206, 211, 248, 212, 211, 213, 206, 201, 192, 212, 107}, 10, false};


//: vi_strings
TanData str_handleValue = (TanData){128, (Byte []){246, 233, 223, 243, 244, 242, 233, 238, 231, 243, 210}, 10, false};


//: spa
TanData str_sculptPastaName = (TanData){29, (Byte []){110, 109, 124, 51}, 3, false};


//: name
TanData str_spareTitle = (TanData){35, (Byte []){77, 66, 78, 70, 64}, 4, false};


//: tr_strings
TanData str_ministrationValue = (TanData){115, (Byte []){7, 1, 44, 0, 7, 1, 26, 29, 20, 0, 224}, 10, false};


//: hi_strings
TanData str_moleName = (TanData){147, (Byte []){251, 250, 204, 224, 231, 225, 250, 253, 244, 224, 128}, 10, false};


//: zh_hant_strings
TanData str_rawName = (TanData){96, (Byte []){26, 8, 63, 8, 1, 14, 20, 63, 19, 20, 18, 9, 14, 7, 19, 38}, 15, false};


//: %@/%@.xml
TanData str_flueSpecializeData = (TanData){122, (Byte []){95, 58, 85, 95, 58, 84, 2, 23, 22, 126}, 9, false};


//: id_strings
TanData str_bareContent = (TanData){192, (Byte []){169, 164, 159, 179, 180, 178, 169, 174, 167, 179, 46}, 10, false};


//: sa_strings
TanData str_recentWolfAwarenessData = (TanData){223, (Byte []){172, 190, 128, 172, 171, 173, 182, 177, 184, 172, 166}, 10, false};


//: main_tab_my
TanData str_doctrineFessGinData = (TanData){40, (Byte []){69, 73, 65, 70, 119, 92, 73, 74, 119, 69, 81, 28}, 11, false};


//: pk_strings
TanData str_cellAuraData = (TanData){13, (Byte []){125, 102, 82, 126, 121, 127, 100, 99, 106, 126, 48}, 10, false};


//: pt_strings
TanData str_oyContent = (TanData){255, (Byte []){143, 139, 160, 140, 139, 141, 150, 145, 152, 140, 172}, 10, false};


//: bd_strings
TanData str_ginSignerContent = (TanData){229, (Byte []){135, 129, 186, 150, 145, 151, 140, 139, 130, 150, 12}, 10, false};


//: en_strings
TanData str_wolfNessValue = (TanData){137, (Byte []){236, 231, 214, 250, 253, 251, 224, 231, 238, 250, 147}, 10, false};


//: hant
TanData str_thoughtName = (TanData){231, (Byte []){143, 134, 137, 147, 226}, 4, false};


//: de_strings
TanData str_jazzTitle = (TanData){181, (Byte []){209, 208, 234, 198, 193, 199, 220, 219, 210, 198, 143}, 10, false};


//: ru_strings
TanData str_questionGestureData = (TanData){35, (Byte []){81, 86, 124, 80, 87, 81, 74, 77, 68, 80, 219}, 10, false};


//: ug_strings
TanData str_edgeTitle = (TanData){117, (Byte []){0, 18, 42, 6, 1, 7, 28, 27, 18, 6, 88}, 10, false};


//: string
TanData str_treeTanFishingText = (TanData){118, (Byte []){5, 2, 4, 31, 24, 17, 118}, 6, false};


//: eg_strings
TanData str_ehName = (TanData){126, (Byte []){27, 25, 33, 13, 10, 12, 23, 16, 25, 13, 219}, 10, false};


//: th_strings
TanData str_egoData = (TanData){51, (Byte []){71, 91, 108, 64, 71, 65, 90, 93, 84, 64, 226}, 10, false};


//: ja_strings
TanData str_evolutionaryValue = (TanData){26, (Byte []){112, 123, 69, 105, 110, 104, 115, 116, 125, 105, 150}, 10, false};


//: text
TanData str_threeEveningData = (TanData){219, (Byte []){175, 190, 163, 175, 248}, 4, false};


//: fr_strings
TanData str_ministrationContent = (TanData){152, (Byte []){254, 234, 199, 235, 236, 234, 241, 246, 255, 235, 85}, 10, false};

// __DEBUG__
// __CLOSE_PRINT__
//
//  MaxInformation.m
//  NIM
//
//  Created by 彭爽 on 2022/6/24.
//  Copyright © 2022 Netease. All rights reserved.
//

// __M_A_C_R_O__
//: #import "NTESLanguageManager.h"
#import "MaxInformation.h"
//: #import "XMLReader.h"
#import "PressedHide.h"
//: #import "AppleProjectKit.h"
#import "Indicator.h"
//: #import "SSZipArchiveManager.h"
#import "EnableChildWith.h"

//: @interface NTESLanguageManager ()<NSXMLParserDelegate>
@interface MaxInformation ()<NSXMLParserDelegate>
//: @property (nonatomic ,strong) NSString *currentElementName;
@property (nonatomic ,strong) NSString *currentElementName;
//: @end
@end

//: @implementation NTESLanguageManager
@implementation MaxInformation

//: static NTESLanguageManager *shareInstance = nil;
static MaxInformation *k_cellValue = nil;

//: + (NTESLanguageManager *)shareInstance{
+ (MaxInformation *)beInstance{
    //: @synchronized(self) {
    @synchronized(self) {
        //: if (shareInstance == nil) {
        if (k_cellValue == nil) {
            //: shareInstance = [[NTESLanguageManager alloc] init];
            k_cellValue = [[MaxInformation alloc] init];
            //: shareInstance.langDict = [NSMutableDictionary dictionaryWithCapacity:100];
            k_cellValue.langDict = [NSMutableDictionary dictionaryWithCapacity:100];
        }
        //: return shareInstance;
        return k_cellValue;
    }
}

//: + (NSString *)getTextWithKey:(NSString *)key{
+ (NSString *)off:(NSString *)key{
    //: NSMutableDictionary *dict = [NTESLanguageManager shareInstance].langDict;
    NSMutableDictionary *dict = [MaxInformation beInstance].langDict;
    //: NSString *value = [dict objectForKey:key];
    NSString *value = [dict objectForKey:key];
    //: if (value == nil ) {
    if (value == nil ) {
        //: NSLog(@"value为空========%@",key);
        //: value = @"";
        value = @"";

    }
    //: return value;
    return value;
}

//: - (void)setLanguagre:(NSString *)langType{
- (void)setInfoKey:(NSString *)langType{

//    [self.langDict removeAllObjects];

    //: NSString *resourceType = @"zh_strings";
    NSString *resourceType = StringFromTanData(&str_byShowData);
    //: if ([langType isEqualToString:@"en"]) {
    if ([langType isEqualToString:@"en"]) {
        //: resourceType = @"en_strings";
        resourceType = StringFromTanData(&str_wolfNessValue);
    //: }else if ([langType isEqualToString:@"th"]){
    }else if ([langType isEqualToString:@"th"]){
        //: resourceType = @"th_strings";
        resourceType = StringFromTanData(&str_egoData);
    //: }else if ([langType isEqualToString:@"vi"]){
    }else if ([langType isEqualToString:@"vi"]){
        //: resourceType = @"vi_strings";
        resourceType = StringFromTanData(&str_handleValue);
    //: }else if ([langType isEqualToString:@"hi"]){
    }else if ([langType isEqualToString:@"hi"]){
        //: resourceType = @"hi_strings";
        resourceType = StringFromTanData(&str_moleName);
    //: }else if ([langType isEqualToString:@"ja"]){
    }else if ([langType isEqualToString:@"ja"]){
        //: resourceType = @"ja_strings";
        resourceType = StringFromTanData(&str_evolutionaryValue);
    //: }else if ([langType isEqualToString:@"ko"]){
    }else if ([langType isEqualToString:@"ko"]){
        //: resourceType = @"ko_strings";
        resourceType = StringFromTanData(&str_edgeName);
    //: }else if ([langType isEqualToString:@"spa"]){
    }else if ([langType isEqualToString:StringFromTanData(&str_sculptPastaName)]){
        //: resourceType = @"spa_strings";
        resourceType = StringFromTanData(&str_vaccinePotValue);
    //: }else if ([langType isEqualToString:@"pt"]){
    }else if ([langType isEqualToString:@"pt"]){
        //: resourceType = @"pt_strings";
        resourceType = StringFromTanData(&str_oyContent);
    //: }else if ([langType isEqualToString:@"id"]){
    }else if ([langType isEqualToString:@"id"]){
        //: resourceType = @"id_strings";
        resourceType = StringFromTanData(&str_bareContent);
    //: }else if ([langType isEqualToString:@"it"]){
    }else if ([langType isEqualToString:@"it"]){
        //: resourceType = @"it_strings";
        resourceType = StringFromTanData(&str_advanceSpeciallyData);
    //: }else if ([langType isEqualToString:@"eg"]){
    }else if ([langType isEqualToString:@"eg"]){
        //: resourceType = @"eg_strings";
        resourceType = StringFromTanData(&str_ehName);
    //: }else if ([langType isEqualToString:@"tr"]){
    }else if ([langType isEqualToString:@"tr"]){
        //: resourceType = @"tr_strings";
        resourceType = StringFromTanData(&str_ministrationValue);
    //: }else if ([langType isEqualToString:@"ug"]){
    }else if ([langType isEqualToString:@"ug"]){
        //: resourceType = @"ug_strings";
        resourceType = StringFromTanData(&str_edgeTitle);
    //: }else if ([langType isEqualToString:@"de"]){
    }else if ([langType isEqualToString:@"de"]){
        //: resourceType = @"de_strings";
        resourceType = StringFromTanData(&str_jazzTitle);
    //: }else if ([langType isEqualToString:@"pk"]){
    }else if ([langType isEqualToString:@"pk"]){
        //: resourceType = @"pk_strings";
        resourceType = StringFromTanData(&str_cellAuraData);
    //: }else if ([langType isEqualToString:@"sa"]){
    }else if ([langType isEqualToString:@"sa"]){
        //: resourceType = @"sa_strings";
        resourceType = StringFromTanData(&str_recentWolfAwarenessData);
    //: }else if ([langType isEqualToString:@"ru"]){
    }else if ([langType isEqualToString:@"ru"]){
        //: resourceType = @"ru_strings";
        resourceType = StringFromTanData(&str_questionGestureData);
    //: }else if ([langType isEqualToString:@"bd"]){
    }else if ([langType isEqualToString:@"bd"]){
        //: resourceType = @"bd_strings";
        resourceType = StringFromTanData(&str_ginSignerContent);
    //: }else if ([langType isEqualToString:@"fr"]){
    }else if ([langType isEqualToString:@"fr"]){
        //: resourceType = @"fr_strings";
        resourceType = StringFromTanData(&str_ministrationContent);
    //: }else if ([langType isEqualToString:@"hant"]){
    }else if ([langType isEqualToString:StringFromTanData(&str_thoughtName)]){
        //: resourceType = @"zh_hant_strings";
        resourceType = StringFromTanData(&str_rawName);
    }

    //: NSString *xmlFilePath = [[[SSZipArchiveManager sharedManager] getXML_filePath] stringByAppendingPathComponent:[NSString stringWithFormat:@"%@/%@.xml", langType, resourceType]];
    NSString *xmlFilePath = [[[EnableChildWith containerMessage] capture] stringByAppendingPathComponent:[NSString stringWithFormat:StringFromTanData(&str_flueSpecializeData), langType, resourceType]];

    //: if (![[NSFileManager defaultManager] fileExistsAtPath:xmlFilePath]) {
    if (![[NSFileManager defaultManager] fileExistsAtPath:xmlFilePath]) {
        //: NSLog(@"XML file not found at path: %@", xmlFilePath);
        //: return;
        return;
    }

    //: NSData *xmlData = [NSData dataWithContentsOfFile:xmlFilePath];
    NSData *xmlData = [NSData dataWithContentsOfFile:xmlFilePath];
    //: if (!xmlData) {
    if (!xmlData) {
        //: NSLog(@"Failed to load XML data from file: %@", xmlFilePath);
        //: return;
        return;
    }

    //: NSError *error = nil;
    NSError *error = nil;
    //: if (error) {
    if (error) {
        //: NSLog(@"error : %@", error);
    }
    //: NSDictionary *result = [XMLReader dictionaryForXMLData:xmlData error:&error];
    NSDictionary *result = [PressedHide compartment:xmlData stainComment:&error];
//    NSDictionary *result = [NSDictionary dictionaryWithXML:xmlData];

    //: NSLog(@"result : %@", result);
    //: if (result) {
    if (result) {
        //: NSDictionary *resources = [result objectForKey:@"resources"];
        NSDictionary *resources = [result objectForKey:StringFromTanData(&str_rawWeaponTitle)];
        //: if (resources) {
        if (resources) {
            //: NSArray *string = [resources objectForKey:@"string"];
            NSArray *string = [resources objectForKey:StringFromTanData(&str_treeTanFishingText)];
            //: if (string.count > 0) {
            if (string.count > 0) {
                //: [string enumerateObjectsUsingBlock:^(NSDictionary *obj, NSUInteger idx, BOOL * _Nonnull stop) {
                [string enumerateObjectsUsingBlock:^(NSDictionary *obj, NSUInteger idx, BOOL * _Nonnull stop) {
                    //: NSString *name = [obj objectForKey:@"name"];
                    NSString *name = [obj objectForKey:StringFromTanData(&str_spareTitle)];
                    //: NSString *text = [obj objectForKey:@"text"];
                    NSString *text = [obj objectForKey:StringFromTanData(&str_threeEveningData)];
                    //: [self.langDict setObject:text forKey:name];
                    [self.langDict setObject:text forKey:name];
                //: }];
                }];
            }
        }

//        NSArray *string = [result objectForKey:@"string"];
//        if (string.count > 0) {
//            [string enumerateObjectsUsingBlock:^(NSDictionary *obj, NSUInteger idx, BOOL * _Nonnull stop) {
//                NSString *name = [obj objectForKey:@"name"];
//                NSString *text = [obj objectForKey:@"_text"];
//                [self.langDict setObject:text forKey:name];
//            }];
//        }
    }
}

// 开始
//: - (void)parserDidStartDocument:(NSXMLParser *)parser {
- (void)parserDidStartDocument:(NSXMLParser *)parser {

    //: NSLog(@"开始");
}
//: - (void)parser:(NSXMLParser *)parser parseErrorOccurred:(NSError *)parseError{
- (void)parser:(NSXMLParser *)parser parseErrorOccurred:(NSError *)parseError{
    //: NSLog(@"出错");
}

// 获取节点头
//: - (void)parser:(NSXMLParser *)parser didStartElement:(NSString *)elementName namespaceURI:(NSString *)namespaceURI qualifiedName:(NSString *)qName attributes:(NSDictionary<NSString *,NSString *> *)attributeDict {
- (void)parser:(NSXMLParser *)parser didStartElement:(NSString *)elementName namespaceURI:(NSString *)namespaceURI qualifiedName:(NSString *)qName attributes:(NSDictionary<NSString *,NSString *> *)attributeDict {

    //: if ([elementName isEqualToString:@"string"]) {
    if ([elementName isEqualToString:StringFromTanData(&str_treeTanFishingText)]) {
        //: self.currentElementName = attributeDict[@"name"];
        self.currentElementName = attributeDict[StringFromTanData(&str_spareTitle)];
        //NSLog(@"--------%@",_currentElementName);
    }

}

// 获取节点的值 (这个方法在获取到节点头和节点尾后，会分别调用一次)
//: - (void)parser:(NSXMLParser *)parser foundCharacters:(NSString *)string {
- (void)parser:(NSXMLParser *)parser foundCharacters:(NSString *)string {
    //: if (_currentElementName != nil) {
    if (_currentElementName != nil) {
        //: if ([_currentElementName isEqualToString:@"main_tab_my"]) {
        if ([_currentElementName isEqualToString:StringFromTanData(&str_doctrineFessGinData)]) {
            //: NSLog(@"%@",string);
        }
        //: [self.langDict setObject:string forKey:_currentElementName];
        [self.langDict setObject:string forKey:_currentElementName];
    }
}

// 获取节点尾
//: - (void)parser:(NSXMLParser *)parser didEndElement:(NSString *)elementName namespaceURI:(NSString *)namespaceURI qualifiedName:(NSString *)qName {
- (void)parser:(NSXMLParser *)parser didEndElement:(NSString *)elementName namespaceURI:(NSString *)namespaceURI qualifiedName:(NSString *)qName {

    //: _currentElementName = nil;
    _currentElementName = nil;
//    NSLog(@"end element : %@---%@----%@", elementName,namespaceURI,qName);


}

// 结束
//: - (void)parserDidEndDocument:(NSXMLParser *)parser {
- (void)parserDidEndDocument:(NSXMLParser *)parser {

    //: NSLog(@"结束");
    //: NSLog(@"%@",self.langDict);

    //发送修改语言通知

}

//: + (NSString *)getLocale{
+ (NSString *)monitor{//th-TH  vi-VN
//    NSString *language = [WastepaperBasketDefaults standardUserDefaults].language;
    //: NSString *locale = @"zh_CN";
    NSString *locale = StringFromTanData(&str_biologicTitle);
//    if ([language isEqualToString:@"en"]) {
//        return @"en_US";
//    }
    //: return locale;
    return locale;
}


//: @end
@end

Byte *TanDataToByte(TanData *data) {
    if (data->auraHare) return data->refugeeConservation;
    for (int i = 0; i < data->quitView; i++) {
        data->refugeeConservation[i] ^= data->fishingEconomist;
    }
    data->refugeeConservation[data->quitView] = 0;
    data->auraHare = true;
    return data->refugeeConservation;
}

NSString *StringFromTanData(TanData *data) {
    return [NSString stringWithUTF8String:(char *)TanDataToByte(data)];
}
