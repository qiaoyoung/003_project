
#import <Foundation/Foundation.h>

NSString *StringFromInformData(Byte *data);        


//: fired
Byte str_scheduleContent[] = {65, 5, 8, 6, 222, 187, 94, 97, 106, 93, 92, 102};


//: sendPacketId
Byte str_curiousVendTitle[] = {61, 12, 51, 6, 101, 173, 64, 50, 59, 49, 29, 46, 48, 56, 50, 65, 22, 49, 176};


//: compressed
Byte str_onSuraName[] = {84, 10, 84, 10, 214, 43, 120, 229, 122, 45, 15, 27, 25, 28, 30, 17, 31, 31, 17, 16, 146};


//: password
Byte str_fromThreadContent[] = {20, 8, 64, 13, 122, 113, 248, 128, 115, 58, 224, 97, 253, 48, 33, 51, 51, 55, 47, 50, 36, 23};


//: personCardId
Byte str_inputTownValue[] = {28, 12, 55, 12, 21, 248, 130, 226, 94, 81, 90, 60, 57, 46, 59, 60, 56, 55, 12, 42, 59, 45, 18, 45, 175};


//: encrypted
Byte str_flavorPowderTitle[] = {71, 9, 13, 13, 147, 215, 188, 65, 38, 173, 94, 223, 165, 88, 97, 86, 101, 108, 99, 103, 88, 87, 41};


//: value
Byte str_suraJurorData[] = {7, 5, 65, 10, 208, 238, 163, 54, 119, 151, 53, 32, 43, 52, 36, 165};


//: title
Byte str_attractiveSizeData[] = {73, 5, 60, 4, 56, 45, 56, 48, 41, 201};


//: sessionId
Byte str_customChangeValue[] = {27, 9, 51, 6, 175, 218, 64, 50, 64, 64, 54, 60, 59, 22, 49, 31};


//: type
Byte str_viewRecentTitle[] = {6, 4, 84, 13, 209, 105, 240, 151, 174, 114, 95, 118, 112, 32, 37, 28, 17, 117};


//: isGetDone
Byte str_attendanceData[] = {48, 9, 47, 10, 136, 48, 178, 5, 50, 222, 58, 68, 24, 54, 69, 21, 64, 63, 54, 156};


//: flag
Byte str_sendLeaderValue[] = {88, 4, 26, 12, 184, 24, 54, 81, 40, 112, 251, 71, 76, 82, 71, 77, 207};


//: redPacketSendID
Byte str_plainContent[] = {89, 15, 60, 11, 88, 30, 252, 96, 46, 81, 51, 54, 41, 40, 20, 37, 39, 47, 41, 56, 23, 41, 50, 40, 13, 8, 97};


//: messageAbstract
Byte str_wolfTitle[] = {78, 15, 24, 11, 96, 145, 125, 193, 29, 14, 113, 85, 77, 91, 91, 73, 79, 77, 41, 74, 91, 92, 90, 73, 75, 92, 217};


//: md5
Byte str_textLengthTitleValue[] = {29, 3, 22, 5, 190, 87, 78, 31, 180};


//: fileName
Byte str_workplaceText[] = {79, 8, 41, 6, 60, 94, 61, 64, 67, 60, 37, 56, 68, 60, 71};


//: openPacketId
Byte str_recognizeName[] = {96, 12, 79, 8, 83, 246, 6, 193, 32, 33, 22, 31, 1, 18, 20, 28, 22, 37, 250, 21, 239};


//: content
Byte str_iconViewTitle[] = {30, 7, 28, 9, 30, 240, 245, 131, 32, 71, 83, 82, 88, 73, 82, 88, 210};


//: redPacketId
Byte str_modelCornerName[] = {69, 11, 65, 14, 39, 171, 80, 32, 193, 235, 133, 177, 195, 119, 49, 36, 35, 15, 32, 34, 42, 36, 51, 8, 35, 137};


//: data
Byte str_fedPastaName[] = {96, 4, 93, 8, 130, 71, 12, 72, 7, 4, 23, 4, 147};


//: url
Byte str_viewVendData[] = {37, 3, 42, 8, 119, 126, 71, 223, 75, 72, 66, 217};


//: sessionName
Byte str_viewOwnValue[] = {88, 11, 64, 10, 109, 172, 7, 134, 110, 237, 51, 37, 51, 51, 41, 47, 46, 14, 33, 45, 37, 177};

// __DEBUG__
// __CLOSE_PRINT__
//
//  CenterHide.m
//  NIM
//
//  Created by amao on 7/2/15.
//  Copyright (c) 2015 Netease. All rights reserved.
//

// __M_A_C_R_O__
//: #import "NTESCustomAttachmentDecoder.h"
#import "CenterHide.h"
//: #import "NTESCustomAttachmentDefines.h"
#import "NTESCustomAttachmentDefines.h"
//: #import "NTESJanKenPonAttachment.h"
#import "MaxOnStatusAttachment.h"
//: #import "NTESSnapchatAttachment.h"
#import "TopOfTap.h"
//: #import "NTESWhiteboardAttachment.h"
#import "ToContainer.h"
//: #import "NTESRedPacketAttachment.h"
#import "MarkTing.h"
//: #import "NTESRedPacketTipAttachment.h"
#import "LightNameAttachment.h"
//: #import "NTESMultiRetweetAttachment.h"
#import "AttachmentHide.h"
//: #import "NSDictionary+NTESJson.h"
#import "NSDictionary+Jv.h"
//: #import "NTESSessionUtil.h"
#import "ChildMark.h"
//: #import "NTESShareCardAttachment.h"
#import "ViewTitleAttachment.h"

//: @implementation NTESCustomAttachmentDecoder
@implementation CenterHide
//: - (id<NIMCustomAttachment>)decodeAttachment:(NSString *)content
- (id<NIMCustomAttachment>)decodeAttachment:(NSString *)content
{
    //: id<NIMCustomAttachment> attachment = nil;
    id<NIMCustomAttachment> attachment = nil;

    //: NSData *data = [content dataUsingEncoding:NSUTF8StringEncoding];
    NSData *data = [content dataUsingEncoding:NSUTF8StringEncoding];
    //: if (data) {
    if (data) {
        //: NSDictionary *dict = [NSJSONSerialization JSONObjectWithData:data
        NSDictionary *dict = [NSJSONSerialization JSONObjectWithData:data
                                                             //: options:0
                                                             options:0
                                                               //: error:nil];
                                                               error:nil];
        //: if ([dict isKindOfClass:[NSDictionary class]])
        if ([dict isKindOfClass:[NSDictionary class]])
        {
            //: NSInteger type = [dict jsonInteger:@"type"];
            NSInteger type = [dict app:StringFromInformData(str_viewRecentTitle)];
            //: NSDictionary *data = [dict jsonDict:@"data"];
            NSDictionary *data = [dict jsonLikeDict:StringFromInformData(str_fedPastaName)];
            //: switch (type) {
            switch (type) {
                //: case CustomMessageTypeJanKenPon:
                case CustomMessageTypeJanKenPon:
                {
                    //: attachment = [[NTESJanKenPonAttachment alloc] init];
                    attachment = [[MaxOnStatusAttachment alloc] init];
                    //: ((NTESJanKenPonAttachment *)attachment).value = [data jsonInteger:@"value"];
                    ((MaxOnStatusAttachment *)attachment).value = [data app:StringFromInformData(str_suraJurorData)];
                }
                    //: break;
                    break;
                //: case CustomMessageTypeSnapchat:
                case CustomMessageTypeSnapchat:
                {
                    //: attachment = [[NTESSnapchatAttachment alloc] init];
                    attachment = [[TopOfTap alloc] init];
                    //: ((NTESSnapchatAttachment *)attachment).md5 = [data jsonString:@"md5"];
                    ((TopOfTap *)attachment).md5 = [data twine:StringFromInformData(str_textLengthTitleValue)];
                    //: ((NTESSnapchatAttachment *)attachment).url = [data jsonString:@"url"];
                    ((TopOfTap *)attachment).url = [data twine:StringFromInformData(str_viewVendData)];
                    //: ((NTESSnapchatAttachment *)attachment).isFired = [data jsonBool:@"fired"];
                    ((TopOfTap *)attachment).isFired = [data green:StringFromInformData(str_scheduleContent)];
                }
                    //: break;
                    break;
                //: case CustomMessageTypeWhiteboard:
                case CustomMessageTypeWhiteboard:
                {
                    //: attachment = [[NTESWhiteboardAttachment alloc] init];
                    attachment = [[ToContainer alloc] init];
                    //: ((NTESWhiteboardAttachment *)attachment).flag = [data jsonInteger:@"flag"];
                    ((ToContainer *)attachment).flag = [data app:StringFromInformData(str_sendLeaderValue)];
                }
                    //: break;
                    break;
                //: case CustomMessageTypeRedPacket:
                case CustomMessageTypeRedPacket:
                {
                    //: attachment = [[NTESRedPacketAttachment alloc] init];
                    attachment = [[MarkTing alloc] init];
                    //: ((NTESRedPacketAttachment *)attachment).title = [data jsonString:@"title"];
                    ((MarkTing *)attachment).title = [data twine:StringFromInformData(str_attractiveSizeData)];
                    //: ((NTESRedPacketAttachment *)attachment).content = [data jsonString:@"content"];
                    ((MarkTing *)attachment).content = [data twine:StringFromInformData(str_iconViewTitle)];
                    //: ((NTESRedPacketAttachment *)attachment).redPacketId = [data jsonString:@"redPacketId"];
                    ((MarkTing *)attachment).redPacketId = [data twine:StringFromInformData(str_modelCornerName)];
                    //: ((NTESRedPacketAttachment *)attachment).sendID = [data jsonString:@"redPacketSendID"];
                    ((MarkTing *)attachment).sendID = [data twine:StringFromInformData(str_plainContent)];

                }
                    //: break;
                    break;
                //: case CustomMessageTypeRedPacketTip:
                case CustomMessageTypeRedPacketTip:
                {
                    //: attachment = [[NTESRedPacketTipAttachment alloc] init];
                    attachment = [[LightNameAttachment alloc] init];
                    //: ((NTESRedPacketTipAttachment *)attachment).sendPacketId = [data jsonString:@"sendPacketId"];
                    ((LightNameAttachment *)attachment).sendPacketId = [data twine:StringFromInformData(str_curiousVendTitle)];
                    //: ((NTESRedPacketTipAttachment *)attachment).packetId = [data jsonString:@"redPacketId"];
                    ((LightNameAttachment *)attachment).packetId = [data twine:StringFromInformData(str_modelCornerName)];
                    //: ((NTESRedPacketTipAttachment *)attachment).isGetDone = [data jsonString:@"isGetDone"];
                    ((LightNameAttachment *)attachment).isGetDone = [data twine:StringFromInformData(str_attendanceData)];
                    //: ((NTESRedPacketTipAttachment *)attachment).openPacketId = [data jsonString:@"openPacketId"];
                    ((LightNameAttachment *)attachment).openPacketId = [data twine:StringFromInformData(str_recognizeName)];
                }
                    //: break;
                    break;
                //: case CustomMessageTypeMultiRetweet:
                case CustomMessageTypeMultiRetweet:
                {
                    //: attachment = [[NTESMultiRetweetAttachment alloc] init];
                    attachment = [[AttachmentHide alloc] init];
                    //: ((NTESMultiRetweetAttachment *)attachment).url = [data jsonString:@"url"];
                    ((AttachmentHide *)attachment).url = [data twine:StringFromInformData(str_viewVendData)];
                    //: ((NTESMultiRetweetAttachment *)attachment).md5 = [data jsonString:@"md5"];
                    ((AttachmentHide *)attachment).md5 = [data twine:StringFromInformData(str_textLengthTitleValue)];
                    //: ((NTESMultiRetweetAttachment *)attachment).fileName = [data jsonString:@"fileName"];
                    ((AttachmentHide *)attachment).fileName = [data twine:StringFromInformData(str_workplaceText)];
                    //: ((NTESMultiRetweetAttachment *)attachment).compressed = [data jsonBool:@"compressed"];
                    ((AttachmentHide *)attachment).compressed = [data green:StringFromInformData(str_onSuraName)];
                    //: ((NTESMultiRetweetAttachment *)attachment).encrypted = [data jsonBool:@"encrypted"];
                    ((AttachmentHide *)attachment).encrypted = [data green:StringFromInformData(str_flavorPowderTitle)];
                    //: ((NTESMultiRetweetAttachment *)attachment).password = [data jsonString:@"password"];
                    ((AttachmentHide *)attachment).password = [data twine:StringFromInformData(str_fromThreadContent)];
                    //: ((NTESMultiRetweetAttachment *)attachment).messageAbstract = [data jsonArray:@"messageAbstract"];
                    ((AttachmentHide *)attachment).messageAbstract = [data jsonTool:StringFromInformData(str_wolfTitle)];
                    //: ((NTESMultiRetweetAttachment *)attachment).sessionName = [data jsonString:@"sessionName"];
                    ((AttachmentHide *)attachment).sessionName = [data twine:StringFromInformData(str_viewOwnValue)];
                    //: ((NTESMultiRetweetAttachment *)attachment).sessionId = [data jsonString:@"sessionId"];
                    ((AttachmentHide *)attachment).sessionId = [data twine:StringFromInformData(str_customChangeValue)];
                }
                    //: break;
                    break;

                //: case CustomMessageTypeCard:
                case CustomMessageTypeCard:
                {
                    //: attachment = [[NTESShareCardAttachment alloc] init];
                    attachment = [[ViewTitleAttachment alloc] init];
                    //: ((NTESShareCardAttachment *)attachment).title = [data jsonString:@"title"];
                    ((ViewTitleAttachment *)attachment).title = [data twine:StringFromInformData(str_attractiveSizeData)];
                    //: ((NTESShareCardAttachment *)attachment).type = [data jsonString:@"type"];
                    ((ViewTitleAttachment *)attachment).type = [data twine:StringFromInformData(str_viewRecentTitle)];
                    //: ((NTESShareCardAttachment *)attachment).content = [data jsonString:@"content"];
                    ((ViewTitleAttachment *)attachment).content = [data twine:StringFromInformData(str_iconViewTitle)];
                    //: ((NTESShareCardAttachment *)attachment).personCardId = [data jsonString:@"personCardId"];
                    ((ViewTitleAttachment *)attachment).personCardId = [data twine:StringFromInformData(str_inputTownValue)];
                }
                    //: break;
                    break;
                //: default:
                default:
                    //: break;
                    break;
            }
            //: attachment = [self checkAttachment:attachment] ? attachment : nil;
            attachment = [self bar:attachment] ? attachment : nil;
        }
    }
    //: return attachment;
    return attachment;
}


//: - (BOOL)checkAttachment:(id<NIMCustomAttachment>)attachment{
- (BOOL)bar:(id<NIMCustomAttachment>)attachment{
    //: BOOL check = NO;
    BOOL check = NO;
    //: if ([attachment isKindOfClass:[NTESJanKenPonAttachment class]])
    if ([attachment isKindOfClass:[MaxOnStatusAttachment class]])
    {
        //: NSInteger value = [((NTESJanKenPonAttachment *)attachment) value];
        NSInteger value = [((MaxOnStatusAttachment *)attachment) value];
        //: check = (value>=CustomJanKenPonValueKen && value<=CustomJanKenPonValuePon) ? YES : NO;
        check = (value>=CustomJanKenPonValueKen && value<=CustomJanKenPonValuePon) ? YES : NO;
    }
    //: else if ([attachment isKindOfClass:[NTESSnapchatAttachment class]])
    else if ([attachment isKindOfClass:[TopOfTap class]])
    {
        //: check = YES;
        check = YES;
    }
    //: else if ([attachment isKindOfClass:[NTESShareCardAttachment class]])
    else if ([attachment isKindOfClass:[ViewTitleAttachment class]])
    {
        //: check = YES;
        check = YES;
    }
    //: else if ([attachment isKindOfClass:[NTESWhiteboardAttachment class]])
    else if ([attachment isKindOfClass:[ToContainer class]])
    {
        //: NSInteger flag = [((NTESWhiteboardAttachment *)attachment) flag];
        NSInteger flag = [((ToContainer *)attachment) flag];
        //: check = ((flag >= CustomWhiteboardFlagInvite) && (flag <= CustomWhiteboardFlagClose)) ? YES : NO;
        check = ((flag >= CustomWhiteboardFlagInvite) && (flag <= CustomWhiteboardFlagClose)) ? YES : NO;
    }
    //: else if([attachment isKindOfClass:[NTESRedPacketAttachment class]] || [attachment isKindOfClass:[NTESRedPacketTipAttachment class]])
    else if([attachment isKindOfClass:[MarkTing class]] || [attachment isKindOfClass:[LightNameAttachment class]])
    {
        //: check = YES;
        check = YES;
    }
    //: else if ([attachment isKindOfClass:[NTESMultiRetweetAttachment class]])
    else if ([attachment isKindOfClass:[AttachmentHide class]])
    {
        //: NTESMultiRetweetAttachment *target = (NTESMultiRetweetAttachment *)attachment;
        AttachmentHide *target = (AttachmentHide *)attachment;
        //: if (target.messageAbstract.count == 0) {
        if (target.messageAbstract.count == 0) {
            //: check = NO;
            check = NO;
        //: } else if (target.encrypted && target.password.length == 0) {
        } else if (target.encrypted && target.password.length == 0) {
            //: check = NO;
            check = NO;
        //: } else {
        } else {
            //: check = YES;
            check = YES;
        }
    }
    //: return check;
    return check;
}
//: @end
@end

Byte * InformDataToCache(Byte *data) {
    int waste = data[0];
    int warp = data[1];
    Byte information = data[2];
    int cornerRitual = data[3];
    if (!waste) return data + cornerRitual;
    for (int i = cornerRitual; i < cornerRitual + warp; i++) {
        int value = data[i] + information;
        if (value > 255) {
            value -= 256;
        }
        data[i] = value;
    }
    data[0] = 0;
    data[cornerRitual + warp] = 0;
    return data + cornerRitual;
}

NSString *StringFromInformData(Byte *data) {
    return [NSString stringWithUTF8String:(char *)InformDataToCache(data)];
}
